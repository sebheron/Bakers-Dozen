name: Build Bakers Dozen

on:
  push:
    branches:
      - main
  pull_request:
    branches:
      - main

jobs:
  build:
    runs-on: windows-latest

    steps:
    - name: Checkout repository
      uses: actions/checkout@v3

    - name: Install Visual Studio 2017 Build Tools
      run: |
        choco install visualstudio2017buildtools --version 15.9.35 -y
        choco install visualstudio2017-workload-vctools -y

    - name: Download OpenFrameworks
      run: |
        curl -L https://github.com/openframeworks/openFrameworks/archive/refs/tags/0.11.2.zip -o openFrameworks.zip
        mkdir C:\openFrameworks
        tar -xf openFrameworks.zip -C C:\openFrameworks --strip-components=1

    - name: Setup MSBuild
      uses: microsoft/setup-msbuild@v1

    - name: Build solution
      run: msbuild "Bakers Dozen/Bakers Dozen/Bakers Dozen.vcxproj" /p:Configuration=Release
      env:
        OF_ROOT: C:\openFrameworks
